hna._i18nMap.addLanguages({
    "U01": {"zh_CN": "航班号", "en_US": "Flight number"},
    "Lmsg01": {"zh_CN": "数据加载中...", "en_US": "Flight number"},
    "Msg01": {"zh_CN": " 保存成功！", "en_US": "Flight number"},
    "Msg02": {"zh_CN": "确定要删除该条记录吗？", "en_US": "Flight number"},
    "Msg03": {"zh_CN": "删除成功！", "en_US": "Flight number"},
    "Msg04": {"zh_CN": "，{0}秒钟之后，刷新页面！", "en_US": "Flight number"},
    "Mai01": {"zh_CN": "请输入可用的邮箱！", "en_US": "Flight number"},
    "Tit01": {"zh_CN": "个人资料", "en_US": "Flight number"},
    "Tit02": {"zh_CN": "修改邮箱", "en_US": "Flight number"},
    "Tit03": {"zh_CN": "绑定邮箱", "en_US": "Flight number"},
    "Tit04": {"zh_CN": "安全设置", "en_US": "Flight number"},
    "Tit05": {"zh_CN": "修改密码", "en_US": "Flight number"},
    "Tit06": {"zh_CN": "原密码", "en_US": "Flight number"},
    "Tit07": {"zh_CN": "修改手机号", "en_US": "Flight number"},
    "Tit08": {"zh_CN": "修改密保", "en_US": "Flight number"},
    "Tit09": {"zh_CN": "原始密保问题", "en_US": "Flight number"},
    "Tit10": {"zh_CN": "验证邮箱", "en_US": "Flight number"},
    "Tit11": {"zh_CN": "新密码", "en_US": "Flight number"},
    "Tit12": {"zh_CN": "验证手机号", "en_US": "Flight number"},
    "Tit13": {"zh_CN": "你的答案", "en_US": "Flight number"},
    "Tit14": {"zh_CN": "新密保问题", "en_US": "Flight number"},
    "Tit15": {"zh_CN": "你的新答案", "en_US": "Flight number"},
    "Tit16": {"zh_CN": "原邮箱", "en_US": "Flight number"},
    "Tit17": {"zh_CN": "安全设置", "en_US": "Flight number"},
    "Tit18": {"zh_CN": "常用乘机人", "en_US": "Flight number"},
    "Tit19": {"zh_CN": "我的订单", "en_US": "Flight number"},
    "Tit20": {"zh_CN": "会员注册", "en_US": "Flight number"},
    "Tit21": {"zh_CN": "会员登录", "en_US": "Flight number"},
    "Tit22": {"zh_CN": "找回密码", "en_US": "Flight number"},
    "Tit23": {"zh_CN": "证件号码", "en_US": "Flight number"},
    "Tit24": {"zh_CN": "证件类型", "en_US": "Flight number"},
    "Tit25": {"zh_CN": "出生日期", "en_US": "Flight number"},
    "Tit26": {"zh_CN": "旅客类型", "en_US": "Flight number"},
    "Tit27": {"zh_CN": "会员注册", "en_US": "Flight number"},
    "Tit28": {"zh_CN": "国内乘机人", "en_US": "Flight number"},
    "Tit29": {"zh_CN": "国际乘机人", "en_US": "Flight number"},
    "Tit30": {"zh_CN": "乘机人信息", "en_US": "Flight number"},
    "Tit31": {"zh_CN": "国际", "en_US": "Flight number"},
    "Tit32": {"zh_CN": "国内", "en_US": "Flight number"},
    "Tit33": {"zh_CN": "乘机人", "en_US": "Flight number"},
    "UN01": {"zh_CN": "用户名必须以字母开头，包含字母或者数字，6到20位！", "en_US": "Flight number"},
    "Pw01": {"zh_CN": "密码为6到20位数字和字母组合！", "en_US": "Flight number"},
    "Fn01": {"zh_CN": "姓氏", "en_US": "Flight number"},
    //"Ln01": {"zh_CN": "请输入姓氏/lastName", "en_US": "Flight number"},
    "Ln01": {"zh_CN": "姓", "en_US": "Flight number"},
    "Na01": {"zh_CN": "名字", "en_US": "Flight number"},
    //"Fn02": {"zh_CN": "请输入名字/firstName", "en_US": "Flight number"},
    "Fn02": {"zh_CN": "名", "en_US": "Flight number"},
    "Tp01": {"zh_CN": "，{0}秒后刷新页面跳转到首页！", "en_US": "Flight number"},
    "Agr01": {"zh_CN": "《用户注册协议》", "en_US": "Flight number"},
    "Agr02": {"zh_CN": "请查看《用户注册协议》！", "en_US": "Flight number"},
    "Agr03": {"zh_CN": "已阅读并同意", "en_US": "Flight number"},
    "Adr01": {"zh_CN": "邮寄地址", "en_US": "Flight number"},
    "Adr02": {"zh_CN": "序号", "en_US": "Flight number"},
    "Adr03": {"zh_CN": "收件人", "en_US": "Flight number"},
    "Adr04": {"zh_CN": "省份", "en_US": "Flight number"},
    "Adr05": {"zh_CN": "市(区)", "en_US": "Flight number"},
    "Adr06": {"zh_CN": "县(区)", "en_US": "Flight number"},
    "Adr07": {"zh_CN": "详细地址", "en_US": "Flight number"},
    "Adr08": {"zh_CN": "手机号码", "en_US": "Flight number"},
    "Adr09": {"zh_CN": "固定电话", "en_US": "Flight number"},
    "Adr10": {"zh_CN": "邮政编码", "en_US": "Flight number"},
    "Adr11": {"zh_CN": "邮箱", "en_US": "Flight number"},
    "Adr12": {"zh_CN": "操作", "en_US": "Flight number"},
    "Adr13": {"zh_CN": "添加新地址", "en_US": "Flight number"},
    "Adr14": {"zh_CN": "编辑邮寄地址", "en_US": "Flight number"},
    "Adr15": {"zh_CN": "收件人", "en_US": "Flight number"},
    "Adr16": {"zh_CN": "类型", "en_US": "Flight number"},
    "Adr17": {"zh_CN": "国籍", "en_US": "Flight number"},
    "Adr18": {"zh_CN": "姓名", "en_US": "Flight number"},
    "Adr19": {"zh_CN": "护照号码", "en_US": "Flight number"},
    "Adr20": {"zh_CN": "护照签发国", "en_US": "Flight number"},
    "Adr21": {"zh_CN": "护照有效期", "en_US": "Flight number"},
    "Adr22": {"zh_CN": "性别", "en_US": "Flight number"},
    "Dy01": {"zh_CN": "发送动态口令", "en_US": "Flight number"},
    "Psor01": {"zh_CN": "成人(12周岁以上)", "en_US": "Flight number"},
    "Psor02": {"zh_CN": "儿童(2到12周岁)", "en_US": "Flight number"},
    "Psor03": {"zh_CN": "婴儿(14天到2周岁)", "en_US": "Flight number"},
    "Ed01": {"zh_CN": "添加", "en_US": "Flight number"},
    "Ed02": {"zh_CN": "编辑", "en_US": "Flight number"},
    "Ema01": {"zh_CN": "请输入可用的邮箱", "en_US": "Flight number"},
    "CE01": {"zh_CN": "请输入", "en_US": "Flight number"},
    "CE02": {"zh_CN": "请选择", "en_US": "Flight number"},
    "CE03": {"zh_CN": "保存", "en_US": "Flight number"},
    "CE05": {"zh_CN": "注册成为会员后，您可以享有以下服务：", "en_US": "Flight number"},
    "CE06": {"zh_CN": "新鲜优惠资讯", "en_US": "Flight number"},
    "CE07": {"zh_CN": "最低购票价格", "en_US": "Flight number"},
    "CE08": {"zh_CN": "优选机上座位", "en_US": "Flight number"},
    "CE09": {"zh_CN": "航班动态定制", "en_US": "Flight number"},
    "CE10": {"zh_CN": "关注北部湾航空微信公众号", "en_US": "Flight number"},
    "CE11": {"zh_CN": "最高直减200元", "en_US": "Flight number"},
    "CE12": {"zh_CN": "支持购票功能", "en_US": "Flight number"},
    "CE13": {"zh_CN": "人工客服为您解答问题", "en_US": "Flight number"},
    "CE14": {"zh_CN": "随时开启您的出行计划", "en_US": "Flight number"},
    "CE15": {"zh_CN": "新手机号码不能和旧手机号码相同！", "en_US": "Flight number"},
    "CE16": {"zh_CN": "新邮箱不能和旧邮箱相同！", "en_US": "Flight number"},
    "CE17": {"zh_CN": "验证失败", "en_US": "Flight number"},
    "CE18": {"zh_CN": "操作失败", "en_US": "Flight number"},
    "CE19": {"zh_CN": "格式错误", "en_US": "Flight number"},
    "CE20": {"zh_CN": "请输入15位或18位身份证号码", "en_US": "Flight number"},
    "CE21": {"zh_CN": "名(英文，与护照上的一致)", "en_US": "Flight number"},
    "CE22": {"zh_CN": "姓(英文，与护照上的一致)", "en_US": "Flight number"},
    "CE23": {"zh_CN": "请输入准确的护照号码", "en_US": "Flight number"},
    "CE24": {"zh_CN": "请输入准确的军官证号码", "en_US": "Flight number"},
    "CE25": {"zh_CN": "请输入其他证件号码", "en_US": "Flight number"}


});

var _InterTelList = [];

var layoutLeftCla = " user-left";
var layoutRightCla = " user-right";
var _col12 = " col-xs-12 col-sm-12 col-md-12 col-lg-12";
var _classList = ["hnaui-form", "hnaui-form-pane", "hnaui-form-item", "hnaui-form-label", "hnaui-input-block", "p-panel", "hanui-panel-content", "hnaui-clear", "hnaui-icon", "hnaui-btn", "hnaui-verifybtn"];

//创建文本输入框
function createInputElUm(obj) {
    try {
        var o = new ControlElem(obj);
        o.required = o.required === false ? "" : createRequiredElUm();
        if (o.eleType == "firstName") {
            o.verify = "Pname";
            o.title = _i18n("Na01");
        } else if (o.eleType == "lastName") {
            o.verify = "Pname";
            o.title = _i18n("Fn01");
        } else if (o.eleType == "receiveName") {
            o.title = _i18n("Adr15");
        } else if (o.eleType == "birthday" || o.eleType == "cardValidDate") {
            o.classStr += " p-date";
        }

        for (var a = 0, a1 = _verificationElemList.length; a < a1; a++) {
            var item = _verificationElemList[a];
            if (item.type == o.verify) {
                if (!o.title) {
                    o.title = item.title;
                }
                if (o.showIcon && !o.icon) {
                    o.icon = item.icon;
                }
                if (!o.placeholder) {
                    o.placeholder = _i18n("CE01") + item.title + (item.format ? "（" + item.format + "）" : "");
                }
                if (!o.maxLen || item.maxLen != 50) {
                    o.maxLen = item.maxLen;
                }
                break;
            }
        }

        var html = '<div class="' + _col12 + ' p-input">';
        var mobileCla = "";
        if (hna.hasMobilePre && o.eleType == "mobile") {
            html += createMobilePreEl({"value": obj.mobilePreV, "readonly": o.readonly});
            mobileCla = " hnaui-mobile-next";
        }
        html += '       <div class="' + _classList[2] + '">';
        html += '           <label class="' + _classList[3] + '">' + o.required + o.title + '</label>';
        html += '           <div class="' + _classList[4] + mobileCla + '">';
        html += _createStandardInputEl(o);
        if (o.icon) {
            var cla = _classList[8];
            cla += o.icon === "&#xe908;" ? " password" : "";
            html += '               <i class="' + cla + '">' + o.icon + '</i>';
        }
        if (o.uniqueUrl) {
            html += '           <i class="' + _classList[8] + ' hnaui-unique-loading hnaui-anim hnaui-anim-rotate hnaui-anim-loop">&#xe63e;</i>';
        }
        if (o.rightBtn) {
            html += '           <a class="' + _classList[9] + ' ' + _classList[9] + '-small ' + _classList[10] + '">' + _i18n("Dy01") + '</a>';
        }
        html += '           </div>';
        var tipsDirection = "bounceInRight";
        if (o.tipsDirection == "up") {
            tipsDirection = "bounceInUp";
        }
        html += '           <div class="hnaui-warning ' + tipsDirection + '"><i class="' + _classList[8] + '">&#x2716;</i><span class="error-tips"></span></div>';
        html += '       </div>';
        html += '   </div>';
        o = null;
        return html;
    } catch (e) {
        JsErrorTips(e);
        return "";
    }
}
//创建隐藏域
function createHiddenInputUm(obj) {
    var o = new ControlElem(obj);
    return '<input type="hidden" name="' + o.eleType + '" value="' + o.value + '" filter="' + (obj.filter || "Y") + '">';
}
//创建单选按钮
function createRadioElUm(obj) {
    try {
        var o = new ControlElem(obj);
        o.value = !o.value ? _sexTypeList[0].code : o.value;
        o.required = o.required === false ? "" : createRequiredElUm();

        for (var a = 0, a1 = _verificationElemList.length; a < a1; a++) {
            var item = _verificationElemList[a];
            if (item.type == o.verify) {
                if (!o.title) {
                    o.title = item.title;
                }
                if (!o.dataArr || o.dataArr.length == 0) {
                    o.dataArr = item.dataArr;
                }
                break;
            }
        }

        var html = '<div class="' + _col12 + ' p-radio">';
        html += '       <div class="' + _classList[2] + '" pane="">';
        html += '           <label class="' + _classList[3] + '">' + o.required + o.title + '</label>';
        html += '           <div class="' + _classList[4] + '">';
        o.dataArr.forEach(function (item, index) {
            var checked = "";
            if (o.value) {
                if (o.value == item.code) {
                    checked = 'checked';
                }
            } else {
                if (index == 0) {
                    checked = 'checked';
                }
            }
            html += '           <input type="radio" name="' + o.name + '" class="' + o.classStr + '" value="' + item.code + '" title="' + item.name + '" ' + checked + ' hna-verify="' + o.verify + '">';
        });
        html += '           </div>';
        html += '       </div>';
        html += '   </div>';
        o = null;
        return html;
    } catch (e) {
        JsErrorTips(e);
        return "";
    }
}
//创建下拉框
function createSelectElUm(obj) {
    try {
        var o = new ControlElem(obj);
        o.required = o.required === false ? "" : createRequiredElUm();
        if (o.eleType == "passType") {
            o.title = _i18n("Tit26");
            o.dataArr = [
                {
                    "code": "ADT",
                    "name": _i18n("Psor01")
                },
                {
                    "code": "CNN",
                    "name": _i18n("Psor02")
                },
                {
                    "code": "INF",
                    "name": _i18n("Psor03")
                }
            ];
        }

        for (var a = 0, a1 = _verificationElemList.length; a < a1; a++) {
            var item = _verificationElemList[a];
            if (item.type == o.verify) {
                if (!o.title) {
                    o.title = item.title;
                }
                if (!o.dataArr || o.dataArr.length == 0) {
                    o.dataArr = item.dataArr;
                }
                break;
            }
        }

        var html = '<div class="' + _col12 + ' p-select">';
        html += '       <div class="' + _classList[2] + '">';
        html += '           <label class="' + _classList[3] + '">' + o.required + o.title + '</label>';
        html += '           <div class="' + _classList[4] + '">';
        html += '               <select name="' + o.name + '" class="' + o.classStr + '" hna-required="' + (o.required ? "Y" : "N") + '" hna-name="' + o.title + '" hna-filter="' + o.verify + '" ' + (o.readonly ? "disabled" : "") + ' hna-search>';
        html += '                   <option value="">' + _i18n("CE02") + o.title + '</option>';
        o.dataArr.forEach(function (item, index) {
            if (item.code) {
                html += '               <option value="' + (item.code || "") + '"  ' + (o.value == item.code ? "selected" : "") + '>' + (item.name || "") + '</option>';
            }
        });
        html += '               </select>';
        html += '           </div>';
        html += '       </div>';
        html += '   </div>';
        o = null;
        return html;
    } catch (e) {
        JsErrorTips(e);
        return "";
    }
}
//重新渲染下拉框
function renderSelectUm(obj) {
    var o = new ControlElem(obj);
    var html = createSelectElUm({"eleType": o.eleType, "value": o.value, "dataArr": o.dataArr});
    $(".search-result").find("select[name='" + o.name + "']").parents(".p-select").replaceWith(html);
}
//创建提交，保存按钮
function createSubmitBtnElUm(elType, title) {
    if (!elType) {
        elType = "userInfoForm";
    }
    var defaultTitle = title || _i18n("CE03");
    var html = '<div class="search-submit ' + _classList[7] + '" >';
    html += '       <a class="' + _classList[9] + ' ' + _classList[9] + '-theme ' + _classList[9] + '-model" hna-submit hna-filter="' + elType + '"><i class="' + _classList[8] + '">&#xe610;</i>' + defaultTitle + '</a>';
    html += '   </div>';
    return html;
}
//创建必填项标识符
function createRequiredElUm() {
    return '<span class="hnaui-required">*&nbsp;</span>';
}
//创建人机验证El
function createMMVeLUm(id, required) {
    var html = '<div class="' + _col12 + '">';
    html += '       <div class="' + _classList[2] + ' p-mmv">';
    html += '           <label class="' + _classList[3] + '">' + _i18n("B12") + '</label>';
    html += '           <input type="hidden" name="mmvCode" hna-verify="PmmvCode" hna-required="' + (required || "Y") + '" isavailable="N">';
    html += '           <div id="' + (id || "") + '" class="hna-mmv">';
    html += '               <div class="hna-animate">';
    html += '                   <span class="hna-animate-circles hna-animate-an1"></span>';
    html += '                   <span class="hna-animate-circles hna-animate-an2"></span>';
    html += '                   <span class="hna-animate-circles hna-animate-an3"></span>';
    html += '                   <div class="hna-animate-line"></div>';
    html += '               </div>';
    html += '           </div>';
    html += '       </div>';
    html += '   </div>';
    return html;
}

//创建用户中心相关页面文字广告内容
function createAdverTextEl() {
    try {
        var html = '<div class="hnaui-adver-panel">';
        // html += '       <div class="hna-register-msg">';
        // html += '            <h3>' + _i18n("CE05") + '</h3>';
        // html += '            <ul>';
        // html += '               <li>' + _i18n("CE06") + '</li>';
        // html += '               <li>' + _i18n("CE07") + '</li>';
        // html += '               <li>' + _i18n("CE08") + '</li>';
        // html += '               <li>' + _i18n("CE09") + '</li>';
        // html += '           </ul>';
        // html += '       </div>';
        html += '       <div class="hna-register-msg hnaui-clear">';
        html += '            <h3>' + _i18n("CE10") + '</h3>';
        html += '            <p class="hnaui-left"><img src="' + (hna._static_host) + '/images/portal/weChat.jpg" ></p>';
        html += '            <ul class="hnaui-right">';
        html += '               <li>' + _i18n("CE12") + '</li>';
        html += '               <li>' + _i18n("CE13") + '</li>';
        html += '               <li>' + _i18n("CE14") + '</li>';
        html += '           </ul>';
        html += '       </div>';
        html += '   </div>';
        return html;
    } catch (e) {
        JsErrorTips(e);
        return "";
    }
}
//创建用户中心相关页面图片广告内容
function createAdverEl(type) {
    try {
        var num = hna.random(1 , 3);
        var hrefStr = '';
        if (num == 1) {
            hrefStr = "http://mp.weixin.qq.com/s/_QO-Yuq_w-EULehVpxy7TA";
        }else if (num == 2) {
            hrefStr = "http://mp.weixin.qq.com/s/aDFB0FgCOMArqzIpokUPFA";
        }else if (num ==3) {
            hrefStr = "http://app.westair.cn:9006";
        }
        var html = '<div class="hnaui-adver-panel">';
        html += '       <div class="hna-ad-img">';
        html += '           <ul>';
        html += '               <li>';
        html += '                   <a href="'+ hrefStr +'" target="_blank">';
        html += '                   <img src="' + (hna._static_host) + '/images/adver/' + num + '.jpg">';
        html += '                   </a>';
        html += '               </li>';
        html += '           </ul>';
        html += '       </div>';
        html += '   </div>';
        return html;
    } catch (e) {
        JsErrorTips(e);
        return "";
    }
}

var _currentCountryType = 0;

//验证唯一性的加载锁
var _uqLockLoadingCount = 0;


//验证文本框的值，同时绑定失去焦点事件和提交表单的验证
function initInputUm() {
    try {
        //提交表单验证文本框
        var config = {};
        _verificationElemList.forEach(function (i) {
            if (i.verifyFun) {
                config[i.type] = function (value, item) {
                    var verifyTips = i.verifyFun({
                        "elem": item,
                        "passType": getTravellerType($(item)),
                        "typeInfo": i,
                        "flag": "submit",
                        "idType": getTravellerIdType($(item)),
                        "isDomestic": _currentCountryType == 1 ? "N" : "Y"
                    });
                    if (i.type == "Pname") {
                        verifyTips = verifyTips.msg;
                    }

                    if (window._userInfo && value && !verifyTips && $(item).attr("readonly") != "readonly" && $(item).attr("hna-uniqueurl")) {
                        //修改手机号码的时候，判断新手机号码和旧手机号码
                        if (i.type == "Pmobile" && value == _userInfo.mobile) {
                            verifyTips = _i18n("CE15");
                        }
                        //修改邮箱的时候，判断新邮箱和旧邮箱
                        if (i.type == "Pemail" && value == _userInfo.email) {
                            verifyTips = _i18n("CE16");
                        }
                    }

                    //如果用户名是有值，readonly，则不校验
                    if($(item).attr("readonly") == "readonly" && i.type == "PuserName"){
                        verifyTips = "";
                    }

                    //判断唯一性校验的
                    if (!verifyTips) {
                        var thisUniqueTips = $(item).attr("uniqueTips");
                        if (thisUniqueTips) {
                            verifyTips = thisUniqueTips;
                        }
                    }
                    return verifyTips;
                };
            }
        });
        globalFrom.verify(config);

        //表单控件失去焦点的事件
        $(document).on("blur", "input", function (e) {
            e.stopPropagation();
            try {
                var $this = $(this);
                var thisName = $this.attr("name");
                var thisV = ($this.val() || "").trim();
                //去掉文本内容首尾的空格
                $this.val(thisV);

                var $ph = $(".hnaui-placeholder");
                $ph.removeClass("hnaui-input-error");
                if (hna.isBlur || $this.attr("readonly") == "readonly") {
                    return false;
                }
                var verifyTips = "";
                var thisVerify = $this.attr("hna-verify");
                _verificationElemList.forEach(function (item) {
                    if (item.verifyFun) {
                        if (thisVerify == item.type) {
                            verifyTips = item.verifyFun({
                                "elem": $this,
                                "passType": getTravellerType($this),
                                "typeInfo": item,
                                "idType": getTravellerIdType($this),
                                "isDomestic": _currentCountryType == 1 ? "N" : "Y"
                            });
                        }
                    }
                });

                if (window._userInfo && thisV && !verifyTips && $this.attr("hna-uniqueurl")) {
                    //修改手机号码的时候，判断新手机号码和旧手机号码
                    if (thisName == "mobile" && thisV == _userInfo.mobile) {
                        verifyTips = _i18n("CE15");
                        $this.attr("isavailable", "N");
                    }
                    //修改邮箱的时候，判断新邮箱和旧邮箱
                    if (thisName == "email" && thisV == _userInfo.email) {
                        verifyTips = _i18n("CE16");
                        $this.attr("isavailable", "N");
                    }
                }

                var thisUniqueUrl = $this.attr("hna-uniqueUrl");
                var thisReadonly = $this.attr("readonly");
                //正则验证通过，则再根据情况是否判断其唯一性
                if (!verifyTips && thisUniqueUrl && !thisReadonly && thisV) {
                    var obj = {};
                    if (thisName == "mobile") {
                        obj[thisName] = getMobileV($this);
                    } else {
                        obj[thisName] = thisV;
                    }
                    _uqLockLoadingCount++;
                    $this.attr("isavailable", "N");
                    showInputUniqueLoading($this, true);
                    hna.ajax({
                        url: thisUniqueUrl,
                        data: obj,
                        doneCallback: function (data) {
                            _uqLockLoadingCount--;
                            if (data && data.code == "200") {
                                var tips = data.data.message;
                                if (data.data.status == "success") {
                                    tips = "";
                                }
                                showInputUniqueLoading($this, false, tips);
                            } else {
                                _showValidationTips(data.message);
                                showInputUniqueLoading($this, false, _i18n("CE17"));
                            }
                        },
                        failCallback: function (data) {
                            _showValidationTips(data.message);
                            _uqLockLoadingCount--;
                            showInputUniqueLoading($this, false, _i18n("CE17"));
                        }
                    });
                    return false;
                }

                if (thisVerify == "Pname" && typeof (verifyTips) == "object") {
                    var tips = verifyTips.msg;
                    //错误提示语长度超过25，则弹窗提示
                    if (tips.length > 25) {
                        _showValidationTips(tips);
                    }

                    if (verifyTips.firstName) {
                        showInputErrorTips(verifyTips.firstName, verifyTips.firstNameTips);
                    }
                    if (verifyTips.lastName) {
                        showInputErrorTips(verifyTips.lastName, verifyTips.lastNameTips);
                    }

                } else {
                    //错误提示语长度超过25，则弹窗提示
                    if (verifyTips.length > 25) {
                        _showValidationTips(verifyTips);
                    }
                    showInputErrorTips($this, verifyTips);

                    //针对乘机人，手动输入出生日期
                    if ($this.attr("name") == "birthday") {
                        var passType = window.getPassTypeByBirthday && getPassTypeByBirthday(thisV);
                        var $passengerInfoForm = $this.parents(".passenger-info-form");
                        $passengerInfoForm.find("select[name='passType']").val(passType);
                        $this.attr("isavailable", "Y");
                        renderFrom();
                    }
                }

                if (window.setRegisterBtnStyle) {
                    setRegisterBtnStyle();
                }

            } catch (ev) {
                JsErrorTips(ev);
            }
        });
    } catch (e) {
        JsErrorTips(e);
    }
}

function getMobileV(thisP) {
    return (new Mobile({
        "mobile": thisP.val(),
        "mobilePre": thisP.parents(".p-panel").find("select[name='mobilePre']").val()
    })).mobile;
}

//监听下拉框改变事件
function initSelectUm() {
    try {
        //监听证件类型改变事件
        globalFrom.on('select(PidType)', function (data) {
            var $this = $(data.elem);
            var $paretns = $this.parents("." + _classList[5]);
            if (data.value == "ID_CARD") {
                $paretns.find(".birthday").attr("readonly", "readonly");
            } else {
                $paretns.find(".birthday").removeAttr("readonly");
            }
            //清空证件号码和出生日期
            $paretns.find(".idNo").val("").trigger("blur");
            $paretns.find(".birthday").val("").trigger("blur");
            $this.parents(".p-panel").find("input.firstName").trigger("blur");

            resetInputPlaceholder($this, data.value);
        });
        //监听手机号码国家码改变事件
        globalFrom.on('select(PmobilePre)', function (data) {
            var $this = $(data.elem);
            var $paretns = $this.parents("." + _classList[5]);
            $paretns.find(".mobile").val("").trigger("blur");
        });
        //监听国籍改变事件
        globalFrom.on('select(Pcountry)', function (data) {

        });
        //监听护照签发国改变事件
        globalFrom.on('select(PcardIssueCountry)', function (data) {

        });
    } catch (e) {
        JsErrorTips(e);
    }
}


//初始化出生日期控件
function initDateUm() {
    try {
        $(document).on("click focus", ".p-date", function (e) {
            e.stopPropagation();
            var $this = $(this);
            var idType = $this.parents("." + _classList[5]).find(".idType").find("option:selected").val();
            var $passengerInfo = $this.parents(".passenger-info-form");
            var $userInfo = $this.parents(".user-info-form");
            var $register = $this.parents(".register-form ");
            if (idType == "ID_CARD") {
                return false;
            }
            var currentDate = hna._date.getDateInfo().date;
            var pDateOption = {};
            pDateOption.elem = this;
            pDateOption.init = false;
            pDateOption.adaptation = false;

            if ($this.hasClass("birthday")) {
                //如果是出生日期控件，则日期控件的最大日期不能超过当天
                pDateOption.max = currentDate;
                if ($passengerInfo.length > 0) {
                    //如果是乘机人的出生日期，则日期控件的最大值应该是在14天前
                    //pDateOption.max = hna._date.addYear(-2);
                    pDateOption.max = hna._date.addDate(-14);
                    if (idType == "MI_CARD") {
                        //如果证件类型是军官证，则表明是成人，则日期控件的最大值应该是在12年前   5740
                        pDateOption.max = hna._date.addYear(-12);
                    }
                }
                if ($userInfo.length > 0 || $register.length > 0) {
                    if (idType == "MI_CARD") {
                        //如果证件类型是军官证，则表明是成人，则日期控件的最大值应该是在12年前   5740
                        pDateOption.max = hna._date.addYear(-12);
                    }
                }
            } else if ($this.hasClass("cardValidDate")) {
                //如果是护照有效期控件，则日期控件的最小日期相对于当前日期 最大 当前日期 十年后
                pDateOption.min = currentDate;
                pDateOption.max = hna._date.addYear(10, currentDate);
            }
            pDateOption.start = currentDate;
            pDateOption.choose = function (dates) {
                if ($this.hasClass("birthday") && dates) {
                    var passType = window.getPassTypeByBirthday && getPassTypeByBirthday(dates);
                    $passengerInfo.find("select[name='passType']").val(passType);
                    $this.attr("isavailable", "Y");
                    renderFrom();
                }
                $this.trigger("blur");
            };
            if (!globalDate) {
                globalDate = hnaui.hnadate;
            }
            globalDate(pDateOption);
        });
    } catch (e) {
        JsErrorTips(e);
    }
}
//监听单选按钮改变事件
function initRadioUm() {
    try {
        globalFrom.on('radio(Psex)', function (data) {
            var $this = $(data.elem);
        });
    } catch (e) {
        JsErrorTips(e);
    }
}
//监听选项卡切换事件
function initTabUm() {
    globalElement.on('tab(passengerInfoTab)', function (data) {
        if (data.index == 1) {
            _currentCountryType = 1;
        } else {
            _currentCountryType = 0;
        }
        hideEditPanel();
    });
    globalElement.on('tab(settingInfoTab)', function (data) {
        var index = data.index;
        if (index == 1) {
            if (mmvCode_mobileCount < 1) {
                //初始化人机验证
                if (window.resetMmvMobileEl) {
                    resetMmvMobileEl();
                }
                if (window.resetVerifyMobileEl) {
                    resetVerifyMobileEl();
                }

                mmvCode_mobileCount++;
            }
        } else if (index == 3) {
            if (mmvCode_emailCount < 1) {
                //初始化人机验证
                if (window.resetMmvEmailEl) {
                    resetMmvEmailEl();
                }
                if (window.resetVerifyEmailEl) {
                    resetVerifyEmailEl();
                }

                mmvCode_emailCount++;
            }
        }
    });
}
//验证提交信息
function initSubmitUm() {
    try {
        (_fromListUm || []).forEach(function (item) {
            globalFrom.on("submit(" + (item.type || "") + ")", function (data) {
                var $thisForm = $("." + (item.fromCla || ""));
                hna.verifyForm($thisForm, function () {
                    var fromInfo = hna.getFormParameter($thisForm);
                    if (hna.isFunction(item.callback)) {
                        item.callback(fromInfo);
                    }
                });
                return false;
            });
        });
    } catch (e) {
        JsErrorTips(e);
    }
}

//提交ajax请求
function sendAjaxUm(url, info, doneCallback, failCallback) {
    try {
        _showValidationLoading();
        hna.ajax({
            url: url,
            data: info,
            doneCallback: function (data) {
                hnaer.closeAll();
                if (data && data.code == "200") {
                    if (data.data.status != "success") {
                        var message = data.data.message;
                        if(message.indexOf("||") > -1){
                            message = message.substring(message.indexOf("||") + 2);
                        }
                        _showValidationTips(message || _i18n("CE18"));
                        if (hna.isFunction(failCallback)) {
                            failCallback(data.data);
                        }
                    } else {
                        if (hna.isFunction(doneCallback)) {
                            doneCallback(data.data);
                        }
                    }
                } else {
                    if (hna.isFunction(failCallback)) {
                        failCallback();
                    }
                }
            },
            failCallback: function () {
                if (hna.isFunction(failCallback)) {
                    failCallback();
                }
            }
        });
    } catch (e) {
        JsErrorTips(e);
    }
}

//创建文本框右侧的提示框
function createWarningContentEl(tips) {
    var html = '';
    if (!tips) {
        html += '<i class="hnaui-icon verify-ok">&#xe605;</i>';
        html += '<span class="error-tips"></span>';

    } else {
        html += '<i class="hnaui-icon verify-error">&#x2716;</i>';
        html += '<span class="error-tips">' + tips + '</span>';
    }
    return html;
}

//显示文本框验证的错误信息
function showInputErrorTips(thisP, tips) {
    try {
        thisP = thisP instanceof $ ? thisP : $(thisP);

        if (tips.length > 25) {
            tips = _i18n("CE19");
        }

        var $warning = thisP.parents("." + _classList[2]).find(".hnaui-warning");
        var $passWord =  thisP.parents("." + _classList[2]).find(".password");
        if (tips == "null") {
            $warning.hide();
            $passWord.css("right",8);
        } else {
            var html = createWarningContentEl(tips);
            $warning.html(html).show();
            var passWordW = $($warning).outerWidth();
            if($warning.parents('.login-content').length == 0){
                $passWord.css('right',passWordW+8);
            }
        }
        hna.isBlur = false;
    } catch (e) {
        JsErrorTips(e);
    }
}

//显示与隐藏文本框在做唯一性校验时的动画
function showInputUniqueLoading(thisP, bl, tips) {
    try {
        thisP = thisP instanceof $ ? thisP : $(thisP);
        var $loading = thisP.parents("." + _classList[2]).find(".hnaui-unique-loading");
        var $warning = thisP.parents("." + _classList[2]).find(".hnaui-warning");
        if (bl) {
            $loading.show();
            $warning.hide();
            thisP.attr("readonly", "readonly").attr("verifying", "Y");
        } else {
            $loading.hide();
            if (tips == "null") {
                $warning.hide();
                tips = "";
            } else {
                if (!tips) {
                    thisP.attr("isavailable", "Y");
                }
                var html = createWarningContentEl(tips);
                $warning.html(html).show();
            }
            thisP.removeAttr("readonly").attr("verifying", "N").attr("uniqueTips", tips);
        }
        hna.isBlur = false;
    } catch (e) {
        JsErrorTips(e);
    }

    if (window.setRegisterBtnStyle) {
        setRegisterBtnStyle();
    }
}


//保存,获取当前用户名
var currentUserNameKey = "USER_NAME_KEY_" + hna._code;
function getUserName() {
    return hna._store.getStore(currentUserNameKey) || "";
}
function saveUserName(userName) {
    if ((new RegExp(hna.regex.userName)).test(userName)) {
        hna._store.setStore(currentUserNameKey, userName || "");
    }
}
function getCurrentMobile(mobile) {
    mobile = (mobile || "").substring((mobile || "").indexOf("-") + 1);
    if ((new RegExp(hna.regex.mobile)).test(mobile)) {
        return mobile;
    }
    return "";
}

//公用事件委托
function commonEventInit() {
    try {
        $(document).on("click", ".hnaui-icon", function () {
            var $this = $(this);
            if ($this.hasClass("password")) {
                if (!$this.hasClass("visible")) {
                    $this.html("&#xe909;");
                    $this.prev("input").attr("type", "text");
                    $this.addClass("visible");
                } else {
                    $this.html("&#xe908;");
                    $this.prev("input").attr("type", "password");
                    $this.removeClass("visible");
                }
            } else if ($this.hasClass("verify-error")) {
                $this.parent(".hnaui-warning").hide();
                $(this).parents('.hnaui-form-item').find(".password").css('right',8);                
            }
        });
    } catch (e) {
        JsErrorTips(e);
    }
}


//获取面板乘机人证件类型
function getTravellerIdType(thisP) {
    var type = "";
    try {
        thisP = thisP instanceof $ ? thisP : $(thisP);
        type = thisP.parents(".p-panel").find(".idType").find("option:selected").val();
    } catch (e) {
        JsErrorTips(e);
    }
    return type;
}


//通过证件类型，获取文本框不同的title
function getInputPlaceholderByIdNo(idType) {
    var firstNameStr = _i18n("Fn02");
    var lastNameStr = _i18n("Ln01");
    var idNoStr = _i18n("CE20");
    if (idType == "2.DOC") {
        firstNameStr = _i18n("CE21");
        lastNameStr = _i18n("CE22");
        idNoStr = _i18n("CE23");
    } else if (idType == "MI_CARD") {
        idNoStr = _i18n("CE24");
    } else if (idType == "OTHER_ID") {
        idNoStr = _i18n("CE25");
    }
    return {
        "firstNamePlaceholder": firstNameStr,
        "lastNamePlaceholder": lastNameStr,
        "idNoPlaceholder": idNoStr
    };
}

//重新设置了证件类为护照之后，更改姓，名，证件号的title
function resetInputPlaceholder(thisP, idType) {
    thisP = thisP instanceof $ ? thisP : $(thisP);
    var $panel = thisP.parents(".p-panel");
    var objPlaceholder = getInputPlaceholderByIdNo(idType);
    $panel.find("input.firstName").attr("placeholder", objPlaceholder.firstNamePlaceholder);
    $panel.find("input.lastName").attr("placeholder", objPlaceholder.lastNamePlaceholder);
    $panel.find("input.idNo").attr("placeholder", objPlaceholder.idNoPlaceholder);
    placeholderCompatibleEl();
}


//初始化手机号码国际码
function initMobilePreData(info) {
    try {
        if (!info) {
            info = {};
        }
        hna.jsData.getInterTelData(function (data) {
            _InterTelList = data.data;

            $(".hnaui-mobile-pre").each(function () {
                var $this = $(this);
                var $thisSelect = $this.find("select");
                var thisV = $thisSelect.data("value");
                var thisReadonly = $thisSelect.prop("disabled");
                $this.replaceWith(createMobilePreEl({
                    "value": thisV,
                    "dataArr": _InterTelList,
                    "readonly": thisReadonly
                }));
            });
            if (globalFrom) {
                globalFrom.render("select");
            }
        });
    } catch (e) {
        JsErrorTips(e);
    }
}

function createMobilePreEl(o) {
    if (!o) {
        o = {};
    }
    var html = '';
    try {
        html += '<div class="hnaui-mobile-pre">';
        html += '<select name = "mobilePre" hna-filter="PmobilePre" data-value="' + (o.value || "") + '" ' + (o.readonly ? "disabled" : "") + ' hna-search>';
        (o.dataArr || [{"area_code": 86, "name": "中国"}]).forEach(function (item) {
            if (item.area_code) {
                var selected = "";
                if ((!o.value && item.area_code == "86") || (o.value && o.value == item.area_code)) {
                    selected = "selected";
                }
                html += '<option value="' + (item.area_code || "") + '" ' + selected + '>' + (item.area_code || "") + '</option>';
            }
        });
        if (!o.dataArr) {
            html += '<option value="-1">数据加载中</option>';
        }
        html += '</select>';
        html += '</div>';
    } catch (e) {
        JsErrorTips(e);
        html = '';
    }
    return html;
}

//获取表单乘机人类型
function getTravellerType(thisP) {
    var type = "";
    try {
        thisP = thisP instanceof $ ? thisP : $(thisP);
        var $root = thisP.parents("form.passenger-info-form");
        if ($root.length > 0) {
            var current = hna._date.getDateInfo().date;
            var birthday = $root.find(".birthday").length > 0 ? $root.find(".birthday").val() : current;
            type = getPassTypeByBirthday(birthday , current);
        }
        return type;
    } catch (e) {
        JsErrorTips(e);
        return type;
    }
}